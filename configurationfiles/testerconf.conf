
server {
    listen 127.0.0.1:8080;
    server_name example.com www.example.com;
    client_max_body_size 1000M;

    index index.html;

    error_page 400 /errors/400.html;
    error_page 403 /errors/403.html;
    error_page 404 /errors/404.html;
    error_page 405 /errors/405.html;
    error_page 500 /errors/500.html;

    location / {
        abspath /www/;
        index index.html;
        allow_methods GET POST;
        autoindex off;
    }

    location /uploads/ {
        abspath /www/uploads;
        allow_methods GET POST DELETE;
        upload_path /www/uploads;
        autoindex on;
    }

    location /cgi/ {
        abspath /www/cgi;
        allow_methods GET POST;
        cgiexecutable /usr/bin/python3;
        autoindex off;
    }

    location /old-page/ {
        return 301 /new-page/;
    }

    location /redirect-temp/ {
        return 307 /temporary-target/;
    }

    location /errors/ {
        abspath /www/error_pages;
        allow_methods GET;
        autoindex off;
    }
}

server {
    listen 127.0.0.1:8080;
    server_name admin.example.com;

    index dashboard.html;
    client_max_body_size 5000M;

    location / {
        abspath /www/admin;
        allow_methods GET POST DELETE;
        autoindex off;
    }

    location /admin/cgi/ {
        abspath /www/admin/cgi;
        allow_methods GET POST;
        cgiexecutable /usr/bin/python3;
        autoindex off;
    }
}

server {
    listen 127.0.0.1:8001;
    server_name test.local;

    index index.html;
    client_max_body_size 2000M;

    location / {
        abspath /www/test;
        allow_methods GET;
        autoindex on;
    }

    location /test/cgi/ {
        abspath /www/test/cgi;
        allow_methods POST;
        cgiexecutable /usr/bin/php;
        autoindex off;
    }
}